---
title: "R Notebook Example"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    number_sections: true
    theme: readable
    highlight: tango
---

# Introduction

## What is RMarkdown?
This introduces as to the use of RMarkdown in order to generate either an .html, pdf or word document that contains the code chunks.  

This markdown file shows the basic functionality of how the code is estimated and how to write formulas and is ment as a proof of concept rather than a full fledged tutorial. It includes a table of contents which floats when we scoll down or up.

## Packages in R

R and RStudio provides many packages that enhances the functionalities of the software. Several packages have been written that are of prime importance to different fields of study. Here below are some of the most **important packages**:

*   For data visualization: 
r

    >[7 important packages for visualization](https://towardsdatascience.com/the-7-r-packages-you-should-be-using-for-data-visualisation-e29010cefe51)
 
    1. `ggplot2`
    2. `colourPicker`
    3. `esquisse`
    4. `plotly`
    5. `quantmod`
    6. `RGL`
    7. `patchwork`
    
*   For data science

    >[Top10 packages in ML](https://www.analyticsvidhya.com/blog/2021/04/top-10-r-packages-for-data-science-you-must-know-in-2021/)

    1. 
    2. `tidyr`
    3. `tidyverse`
    4. `caret`
    5. `data.table`
    6. `knitr`
    7. `mlr3`
    8. `xgboost`
    9. `DataExplorer`
    10. `randomForest`

## Rendering an Rmarkdown file
R Markdown generates a new file that contains selected text, code, and results from the .Rmd file. The new file can be a finished web page, PDF, MS Word document, slide show, notebook, handout, book, dashboard, package vignette or other format.

When you run render, R Markdown feeds the .Rmd file to knitr, which executes all of the code chunks and creates a new markdown (.md) document which includes the code and its output.

The markdown file generated by knitr is then processed by pandoc which is responsible for creating the finished format.

This may sound complicated, but R Markdown makes it extremely simple by encapsulating all of the above processing into a single render function. See the diagram below:





## Great places to learn Rmd
A more comprehensive reference for RMarkdown can be seen in the following link:
[R Markdown: The Definitive Guide](https://bookdown.org/yihui/rmarkdown/)

Another great reference comes from this cheatsheet by Adam Pritchard:
[Markdown Cheatsheet](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet)



# Some code examples

## Basics
This is an R Markdown Notebook. When you execute code within the notebook, the results appear beneath the code.

Try executing this chunk by clicking the Run button within the chunk or by placing your cursor inside it and pressing Ctrl+Shift+Enter.


```{r cars plot}
plot(cars)
```

```{r summary cars}
summary(cars)
```

The sample size in this data set is `r length(cars$speed)` observations. The average speed is `r mean(cars$speed)` and the average distance is `r mean(cars$dist)`.

Add a new chunk by clicking the Insert Chunk button on the toolbar or by pressing Ctrl+Alt+I.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the Preview button or press Ctrl+Shift+K to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike Knit, Preview does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

Note the difference between:

```{r rnorm1}
x1 <- rnorm(100)
print(mean(x1))
```

and
```{r rnorm2, eval = FALSE}
x2 <- rnorm(100)
print(mean(x2))
```

By specifying eval = FALSE we are telling R to not evaluate this code. We can check this by looking at the list of variables in our environment:

```{r print ls}
print(ls())
```

We can see that only x1 variables was created.

## Code example for plots

### Box plot, violin plot and dot plot
The R code below generates some data containing the weights by sex (M for male; F for female):

```{r wdata}
set.seed(1234)
wdata = data.frame(
        sex = factor(rep(c("F", "M"), each=200)),
        weight = c(rnorm(200, 55), rnorm(200, 58)))
head(wdata)
```

```{r cowplot package}
library(ggplot2)
library(cowplot)
```

```{r qplots wdata}
# Basic box plot from data frame
a <- qplot(sex, weight, data = wdata, 
      geom= "boxplot", fill = sex)
# Violin plot
b <- qplot(sex, weight, data = wdata, geom = "violin")
# Dot plot
c <- qplot(sex, weight, data = wdata, 
           geom = "dotplot",stackdir = "center",
           binaxis = "y", dotsize = 0.5)
plot_grid(a, b, c, labels  = c('A', 'B', 'C'), label_size = 12)

```

### Another example using iris dataset
```{r plot iris}
a <- ggplot(iris, aes(Sepal.Length, Sepal.Width, color = Species)) + 
  geom_point() +
  theme_cowplot(12)+ theme(legend.position="bottom")

# minimal horizontal grid theme
b <- ggplot(iris, aes(Sepal.Length, fill = Species))+
  geom_density(alpha = 0.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
  theme_minimal_hgrid(12)+ theme(legend.position = "bottom")

plot_grid(a, b, labels = c('A', 'B'), label_size = 12)
```


## Generating the same random numbers

Use of **set.seed()** with the same seed will allow us to generate the same random numbers

For uniformly distributed (flat) random numbers, use runif(). By default, its range is from 0 to 1.
```{r}
set.seed(1233)
q <- runif(10, min=0, max=50)
mean(q)
```

This will do the same thing
```{r}
set.seed(999)
sample(1:100, 20, replace=TRUE) # replace means a number may be repeated
```


To generate integers WITHOUT replacement:
```{r}
set.seed(888)
sample(1:100, 50, replace=FALSE)
```


## Printing output

We can print a model output:
```{r}
my.ols <- lm(mpg ~ disp + cyl, data = mtcars)
summary(my.ols)
```

We can also print the data output:
```{r}
print(head(mtcars))
```

However if we have a large data frame, the nall of the data will be printed. If we want to format it differently, we can use a number of libraries:

```{r}
#DT::datatable(mtcars, width = 400)
```

Note that this interactivity will not work in a .pdf file.

In most cases regarding the output, using the standard print() function will be enough. For model where there is a large amount of output, please print() only the required results. Example:

The coefficients:
```{r}
print(summary(my.ols)$coefficients)
```

We can also use inline code with $R^2=$ 
The coefficient of determination or $R^2$ = `r round(summary(my.ols)$r.squared, 4)`:

## Themes
There are several options that control the appearance of HTML documents:

1. Theme - this specifies the Bootstrap theme to use for the page (themes are drawn from the Bootswatch theme library). Valid themes include default, bootstrap, cerulean, cosmo, darkly, flatly, journal, lumen, paper, readable, sandstone, simplex, spacelab, united, and yeti. Pass null for no theme (in this case you can use the css parameter to add your own styles).

2. Highlight - specifies the syntax highlighting style. Supported styles include default, tango, pygments, kate, monochrome, espresso, zenburn, haddock, breezedark, and textmate. Pass null to prevent syntax highlighting.

3. Smart - indicates whether to produce typographically correct output, converting straight quotes to curly quotes, --- to em-dashes, -- to en-dashes, and ... to ellipses. Note that smart is enabled by default.

## Sample themes
R Markdown is a great way to integrate R code into a document. Examples of the default themes used in R Markdown HTML documents can be seen in the link below.
[R Markdown Theme Gallery](https://www.datadreaming.org/post/r-markdown-theme-gallery/)

## Inserting static images
You can add images to an R Markdown report using markdown syntax as shown in the next paragraph.

The format is exactly the same as hyperlinks, but with the addition of an ! before the brackets and parentheses.

However, when you knit the report, RStudio will only be able to find your image if you have placed it in the right place - RELATIVE to your .Rmd file. This is where good file management becomes extremely important. It is suggested to put all your images in an images folder in the R-markdown project folder. In that case, make sure your path starts with ../image/ along with the correct image name and file extension. Also the closing bracket and the opening parentheses should be close to each other, without any spaces in between.



## Inserting gif images



# Formula examples

## General formulas
Formulas in Markdown are written between the $ symbols for inline formulas, and between $$ symbols for centered formulas.

For example, writing $X_t = \sum_{j = 1}^t \epsilon_j$ produces the following output: 

$$X_t = \sum_{j = 1}^t \epsilon_j$$

## Matrices
If we want to write a matrix, we use (either with $ or $$, and using \quad to separate the different matrices)::

$$
\begin{bmatrix}
\alpha& \beta^{*}\\
\gamma^{*}& \delta
\end{bmatrix} \quad 
\begin{pmatrix}
\alpha& \beta^{*}\\
\gamma^{*}& \delta
\end{pmatrix}
$$

## Equation aligning
Using the align environment and writing & next to the symbols we want to align in each row lets us specify multiple equations aligned by the same symbol, for example:

$$
\begin{align}
Y_{1,t} &= \alpha_1 + \beta_1 X_{1,t} + \epsilon_{1,t} \\
Y_{2,t} &= \alpha_1 + \beta_1 X_{1,t} + \epsilon_{1,t}
\end{align}
$$

Or if we need to write our equation in a different form:

$$
\begin{align}
f(x) & = (a+b)^2 \\
& = a^2+2ab+b^2
\end{align}
$$

Or if we simply have longer names for our variables:

$$\begin{align}
Population_t &= \alpha_1 + \gamma_1 X_{1,t} + \gamma_2 X_{1,t-1} \\
Price_t &= \alpha_2 + \beta_1 Z_{1,t}
\end{align}$$


$$\begin{equation}
\bar{y} = \frac{1}{n}\sum_{i=1}^n y_i
\end{equation}$$

Here is the sample variance:
$$\begin{equation}
\sigma^2 = \frac{\sum\limits_{i=1}^{n}(y_i - \bar{y})^2} {n - 1}
\end{equation}$$



Here is the sample standard deviation:
$$\begin{equation}
\sigma = \sqrt\frac{\sum\limits_{i=1}^{n}(y_i - \bar{y})^2} {n - 1}
\end{equation}$$



Population regression line:
$$\begin{equation}
Y_i = \beta_0 + \beta_1 X_i + \beta_2 X_i + \beta_3 X_i + ... + \beta_n X_i\ + \epsilon_i
\end{equation}$$

Sample regression line:
$$\begin{equation}
\hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1 X_i + \hat{\epsilon}_i
\end{equation}$$

Sample slope:
$$\begin{equation}
\hat{\beta}_1 = \frac{\sum(X_i - \bar{X}) (Y_i - \bar{Y})} {\sum(X_i - \bar{X})^2}
\end{equation}$$

Sample intercept:
$$\begin{equation}
\hat{\beta}_0 = \bar{Y} - \hat{\beta}_1 \bar{X}
\end{equation}$$



## Writing equation systems
We can write the equation systems using the cases environment (note - we are also using the & symbol to align our equations):

$$
f(n) = \begin{cases} 
n/2 &\mbox{if } n \equiv 0 \\
(3n +1)/2 & \mbox{if } n \equiv 1. 
\end{cases} \pmod{2} 
$$

# Conclusion

## Why R Markdown is better than Jupyter Notebook
[Why R Notebook](https://minimaxir.com/2017/06/r-notebooks/)

Jupyter Notebooks, formerly known as IPython Notebooks, are ubiquitous in modern data analysis. The Notebook format allows statistical code and its output to be viewed on any computer in a logical and reproducible manner, avoiding both the confusion caused by unclear code and the inevitable "it only works on my system" curse.

## About R Notebooks

R Notebooks are a format maintained by RStudio, which develops and maintains a large number of open source R packages and tools, most notably the free-for-consumer RStudio R IDE. More specifically, R Notebooks are an extension of the earlier R Markdown *.Rmd* format, useful for rendering analyses into HTML/PDFs, or other cool formats like Tufte handouts or even books. The default output of an R Notebook file is a **_.nb.html_** file, which can be viewed as a webpage on any system. (RPubs has many examples of R Notebooks, however, it is recommended using GitHub Pages to host notebooks publicly).

Here are a few native features of R Notebooks which present an objective advantage over Jupyter Notebooks, particularly those not highlighted in the documentation:

### Version Control
Version control of files with tools such as git is important as it both maintains an explorable database of changes to the code files and also improves collaboration by using a centralized server (e.g. GitHub) where anyone with access to the repository can pull and push changes to the code. In the data science world, large startups such as Stripe and Airbnb have seen a lot of success with this approach.

### Inline Code Rendering
A common practice in Jupyter Notebooks is to print common values as a part of a write-up or testing statistical code. In Jupyter Notebooks, if you want to verify the number of rows in a dataset for exploratory data analysis, you have to add an appropriate print statement to the cell to get the number n rows, and then add a Markdown cell to redundantly describe what you just print in the output.

In R Notebooks, you can skip a step by calling such print statements in-line in the Markdown text, which will then be rendered with the Notebook. This also avoids hard-coding such numbers in the Markdown text if you change the data beforehand (e.g. parameter tuning) or if the values are nontrivial to calculate by hand.

### Metadata
R Notebooks are configured with a YAML header, which can include common attributes such as title, author, date published, and other relevant options. These fields will then be configured correctly in the metadata for HTML/PDF/Handouts output.

### Notebook Theming
As noted in the example metadata above, R Notebooks allow extensive theming. Jupyter Notebooks do support themes, but with a third-party Python package, or placing custom CSS in an odd location.

Like Jupyter Notebooks, the front-end of browser-based R Notebooks is based off of the Bootstrap HTML framework. R Notebooks, however, allow you to natively select the style of code syntax highlighting via highlight (similar options as pygments) and also the entire Bootstrap theme via theme (with a selection from the excellent Bootswatch themes by Thomas Park), giving your Notebook a unique look without adding dependencies.

### Data Tables
When you print a data frame in a Jupyter Notebook, the output appears as a standard boring HTML table. No cell block output is ever truncated. Accidentally printing an entire 100,000+ row table to a Jupyter Notebook is a mistake you only make once.

R Notebook tables are pretty tables with pagination for both rows and columns, and can support large amounts of data if necessary.

### Table of Contents
A Table of Contents always helps navigating, particularly in a PDF export. Jupyter Notebooks requires an extension for a ToC, while R Notebooks will natively create one from section headers (controllable via toc and number_sections). An optional toc_float parameter causes the Table of Contents to float on the left in the browser, making it always accessible.

In conclusion, R Notebooks haven't received much publicity since the benefits aren't immediately obvious, but for the purpose of reproducible analyses, the breadth of native features allows for excellent utility while avoiding dependency hell. Running R in an R Notebook is a significantly better experience than running R in a Jupyter Notebook. The advantages present in R Notebooks can also provide guidance for feature development in other Notebook software, which improves the data analysis ecosystem as a whole.

